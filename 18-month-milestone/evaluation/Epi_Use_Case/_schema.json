{
   "$schema": "https://vega.github.io/schema/vega/v5.json",
   "width": 500,
   "height": 300,
   "scales": [
      {
         "name": "xscale",
         "type": "linear",
         "range": "width",
         "zero": false,
         "domain": {
            "fields": [
               {
                  "data": "distributions",
                  "field": "timepoint"
               },
               {
                  "data": "traces",
                  "field": "timepoint"
               },
               {
                  "data": "points",
                  "field": "timepoint"
               }
            ]
         }
      },
      {
         "name": "yscale",
         "type": "linear",
         "range": "height",
         "nice": true,
         "zero": true,
         "domain": {
            "fields": [
               {
                  "data": "distributions",
                  "field": "lower"
               },
               {
                  "data": "distributions",
                  "field": "upper"
               },
               {
                  "data": "traces",
                  "field": "value"
               },
               {
                  "data": "points",
                  "field": "value"
               }
            ]
         }
      },
      {
         "name": "color",
         "type": "ordinal",
         "range": "category",
         "domain": {
            "fields": [
               {
                  "data": "distributions",
                  "field": "trajectory"
               },
               {
                  "data": "traces",
                  "field": "trajectory"
               },
               {
                  "data": "points",
                  "field": "trajectory"
               }
            ],
            "sort": {
               "order": "ascending"
            }
         }
      }
   ],
   "axes": [
      {
         "name": "x_axis",
         "orient": "bottom",
         "scale": "xscale",
         "zindex": 100
      },
      {
         "name": "y_axis",
         "orient": "left",
         "scale": "yscale",
         "zindex": 100
      }
   ],
   "signals": [
      {
         "name": "clear",
         "value": true,
         "on": [
            {
               "events": "mouseup[!event.item]",
               "update": "true",
               "force": true
            }
         ]
      },
      {
         "name": "shift",
         "value": false,
         "on": [
            {
               "events": "@legendSymbol:click, @legendLabel:click",
               "update": "event.shiftKey",
               "force": true
            }
         ]
      },
      {
         "name": "clicked",
         "value": null,
         "on": [
            {
               "events": "@legendSymbol:click, @legendLabel:click",
               "update": "{value: datum.value}",
               "force": true
            }
         ]
      },
      {
         "name": "clearData",
         "value": true,
         "on": [
            {
               "events": "mouseup[!event.item]",
               "update": "true",
               "force": true
            }
         ]
      },
      {
         "name": "clickedData",
         "value": null,
         "on": [
            {
               "events": "@area:click",
               "update": "{value: datum.trajectory}",
               "force": true
            }
         ]
      }
   ],
   "legends": [
      {
         "name": "color_legend",
         "stroke": "color",
         "encode": {
            "symbols": {
               "name": "legendSymbol",
               "interactive": true,
               "update": {
                  "fill": {
                     "value": "transparent"
                  },
                  "strokeWidth": {
                     "value": 2
                  },
                  "opacity": [
                     {
                        "test": "!length(data('selected')) || indata('selected', 'value', datum.value) || indata('selectedData', 'value', datum.value)",
                        "value": 0.7
                     },
                     {
                        "value": 0.15
                     }
                  ],
                  "size": {
                     "value": 64
                  }
               }
            },
            "labels": {
               "name": "legendLabel",
               "interactive": true,
               "update": {
                  "opacity": [
                     {
                        "test": "!length(data('selectedData')) || indata('selectedData', 'value', datum.value)",
                        "value": 1
                     },
                     {
                        "value": 0.25
                     }
                  ]
               }
            }
         }
      }
   ],
   "marks": [
      {
         "type": "group",
         "zindex": 3,
         "name": "_points",
         "from": {
            "facet": {
               "name": "points_split",
               "data": "points",
               "groupby": "trajectory"
            }
         },
         "marks": [
            {
               "type": "symbol",
               "name": "_points_symbol",
               "from": {
                  "data": "points_split"
               },
               "zindex": 3,
               "encode": {
                  "update": {
                     "x": {
                        "scale": "xscale",
                        "field": "timepoint"
                     },
                     "y": {
                        "scale": "yscale",
                        "field": "value"
                     },
                     "size": {
                        "value": 35
                     },
                     "strokeWidth": {
                        "value": 2
                     },
                     "fill": {
                        "scale": "color",
                        "field": "trajectory"
                     },
                     "stroke": {
                        "scale": "color",
                        "field": "trajectory"
                     },
                     "fillOpacity": [
                        {
                           "test": "!length(data('selected')) || indata('selected', 'value', datum.trajectory)",
                           "value": 0.5
                        },
                        {
                           "value": 0.15
                        }
                     ],
                     "strokeOpacity": [
                        {
                           "test": "!length(data('selected')) || indata('selected', 'value', datum.trajectory)",
                           "value": 0.75
                        },
                        {
                           "value": 0.15
                        }
                     ],
                     "tooltip": {
                        "field": "value"
                     }
                  },
                  "hover": {
                     "fillOpacity": {
                        "value": 0.9
                     }
                  }
               }
            },
            {
               "type": "line",
               "name": "_points_line",
               "from": {
                  "data": "points_split"
               },
               "zindex": 3,
               "encode": {
                  "update": {
                     "x": {
                        "scale": "xscale",
                        "field": "timepoint"
                     },
                     "y": {
                        "scale": "yscale",
                        "field": "value"
                     },
                     "strokeWidth": {
                        "value": 2
                     },
                     "stroke": {
                        "scale": "color",
                        "field": "trajectory"
                     },
                     "interpolate": {
                        "value": "linear"
                     },
                     "strokeDash": {
                        "value": [
                           5,
                           3
                        ]
                     },
                     "strokeOpacity": [
                        {
                           "test": "!length(data('selected')) || indata('selected', 'value', datum.trajectory)",
                           "value": 0.3
                        },
                        {
                           "value": 0.1
                        }
                     ]
                  },
                  "hover": {
                     "fillOpacity": {
                        "value": 0.9
                     }
                  }
               }
            }
         ]
      },
      {
         "type": "group",
         "zindex": 2,
         "name": "_traces",
         "from": {
            "facet": {
               "name": "traces_split",
               "data": "traces",
               "groupby": "trajectory"
            }
         },
         "marks": [
            {
               "type": "line",
               "name": "_traces_lines",
               "from": {
                  "data": "traces_split"
               },
               "encode": {
                  "update": {
                     "x": {
                        "scale": "xscale",
                        "field": "timepoint"
                     },
                     "y": {
                        "scale": "yscale",
                        "field": "value"
                     },
                     "strokeWidth": {
                        "value": 2
                     },
                     "stroke": {
                        "scale": "color",
                        "field": "trajectory"
                     },
                     "interpolate": {
                        "value": "linear"
                     },
                     "strokeOpacity": [
                        {
                           "test": "!length(data('selected')) || indata('selected', 'value', datum.trajectory)",
                           "value": 0.75
                        },
                        {
                           "value": 0.15
                        }
                     ]
                  },
                  "hover": {
                     "fillOpacity": {
                        "value": 0.9
                     }
                  }
               }
            }
         ]
      },
      {
         "type": "group",
         "name": "_distributions",
         "zindex": 1,
         "from": {
            "facet": {
               "name": "trajectory_split",
               "data": "distributions",
               "groupby": "trajectory"
            }
         },
         "marks": [
            {
               "type": "area",
               "name": "area",
               "interactive": true,
               "from": {
                  "data": "trajectory_split"
               },
               "encode": {
                  "update": {
                     "x": {
                        "scale": "xscale",
                        "field": "timepoint"
                     },
                     "y": {
                        "scale": "yscale",
                        "field": "upper"
                     },
                     "y2": {
                        "scale": "yscale",
                        "field": "lower"
                     },
                     "interpolate": {
                        "value": "linear"
                     },
                     "strokeWidth": {
                        "value": 2
                     },
                     "fill": {
                        "scale": "color",
                        "field": "trajectory"
                     },
                     "stroke": {
                        "scale": "color",
                        "field": "trajectory"
                     },
                     "fillOpacity": [
                        {
                           "test": "!length(data('selected')) || indata('selected', 'value', datum.trajectory)",
                           "value": 0.5
                        },
                        {
                           "value": 0.15
                        }
                     ],
                     "strokeOpacity": [
                        {
                           "test": "!length(data('selected')) || indata('selected', 'value', datum.trajectory)",
                           "value": 0.75
                        },
                        {
                           "value": 0.15
                        }
                     ]
                  },
                  "hover": {
                     "fillOpacity": {
                        "value": 0.9
                     }
                  }
               }
            }
         ]
      },
      {
         "type": "group",
         "name": "_markers_v",
         "marks": [
            {
               "type": "rule",
               "name": "_marker_v text",
               "from": {
                  "data": "markers_v"
               },
               "encode": {
                  "enter": {
                     "stroke": {
                        "value": "lightgray"
                     }
                  },
                  "update": {
                     "x": {
                        "scale": "xscale",
                        "field": "axis_value"
                     },
                     "y2": {
                        "value": 0
                     },
                     "y": {
                        "signal": "height"
                     },
                     "opacity": {
                        "value": 1
                     }
                  }
               }
            },
            {
               "type": "text",
               "name": "_marker_v flags",
               "from": {
                  "data": "_marker_v text"
               },
               "encode": {
                  "enter": {
                     "text": {
                        "field": "datum.label"
                     },
                     "y": {
                        "value": 0
                     },
                     "fontSize": {
                        "value": 8
                     }
                  }
               },
               "transform": [
                  {
                     "type": "label",
                     "lineAnchor": "start",
                     "as": [
                        "x",
                        "_y",
                        "opacity",
                        "align",
                        "baseline"
                     ],
                     "offset": [
                        1
                     ],
                     "size": {
                        "signal": "[width, height]"
                     }
                  }
               ]
            }
         ]
      },
      {
         "type": "group",
         "name": "_markers_h",
         "marks": [
            {
               "type": "rule",
               "name": "_marker_h text",
               "from": {
                  "data": "markers_h"
               },
               "encode": {
                  "enter": {
                     "stroke": {
                        "value": "lightgray"
                     }
                  },
                  "update": {
                     "y": {
                        "scale": "yscale",
                        "field": "axis_value"
                     },
                     "x2": {
                        "value": 0
                     },
                     "x": {
                        "signal": "width"
                     },
                     "opacity": {
                        "value": 1
                     }
                  }
               }
            },
            {
               "type": "text",
               "name": "_marker_h flags",
               "from": {
                  "data": "_marker_h text"
               },
               "encode": {
                  "enter": {
                     "text": {
                        "field": "datum.label"
                     },
                     "x": {
                        "signal": "width+20"
                     },
                     "fontSize": {
                        "value": 8
                     }
                  }
               },
               "transform": [
                  {
                     "type": "label",
                     "lineAnchor": "start",
                     "as": [
                        "_x",
                        "y",
                        "opacity",
                        "align",
                        "baseline"
                     ],
                     "offset": [
                        1
                     ],
                     "size": {
                        "signal": "[width, height]"
                     }
                  }
               ]
            }
         ]
      }
   ],
   "data": [
      {
         "name": "distributions",
         "values": [
            {
               "trajectory": "exposed_observable_state",
               "timepoint": 10.0,
               "lower": 23110.51591796875,
               "upper": 2229679.0124999997
            },
            {
               "trajectory": "exposed_observable_state",
               "timepoint": 20.0,
               "lower": 1109266.39375,
               "upper": 26342639.4
            },
            {
               "trajectory": "exposed_observable_state",
               "timepoint": 30.0,
               "lower": 9723461.3,
               "upper": 22774461.7
            },
            {
               "trajectory": "exposed_observable_state",
               "timepoint": 40.0,
               "lower": 4396889.8,
               "upper": 14925861.549999997
            },
            {
               "trajectory": "exposed_observable_state",
               "timepoint": 50.0,
               "lower": 1975650.7875,
               "upper": 6727413.049999999
            },
            {
               "trajectory": "exposed_observable_state",
               "timepoint": 60.0,
               "lower": 887716.715625,
               "upper": 3022842.7499999995
            },
            {
               "trajectory": "exposed_observable_state",
               "timepoint": 70.0,
               "lower": 398876.640625,
               "upper": 1358250.1749999998
            },
            {
               "trajectory": "exposed_observable_state",
               "timepoint": 80.0,
               "lower": 179226.903125,
               "upper": 610301.3156249998
            },
            {
               "trajectory": "exposed_observable_state",
               "timepoint": 90.0,
               "lower": 80531.845703125,
               "upper": 274226.10937499994
            },
            {
               "trajectory": "exposed_observable_state",
               "timepoint": 100.0,
               "lower": 36185.2923828125,
               "upper": 123217.73437499997
            },
            {
               "trajectory": "exposed_observable_state",
               "timepoint": 110.0,
               "lower": 16259.09853515625,
               "upper": 55365.29179687499
            },
            {
               "trajectory": "exposed_observable_state",
               "timepoint": 120.0,
               "lower": 7305.684033203125,
               "upper": 24877.234667968743
            },
            {
               "trajectory": "exposed_observable_state",
               "timepoint": 130.0,
               "lower": 3282.6557373046876,
               "upper": 11178.061083984372
            },
            {
               "trajectory": "exposed_observable_state",
               "timepoint": 140.0,
               "lower": 1474.9923767089845,
               "upper": 5022.6266113281235
            },
            {
               "trajectory": "infected_observable_state",
               "timepoint": 10.0,
               "lower": 4127.689965820313,
               "upper": 213787.9359375
            },
            {
               "trajectory": "infected_observable_state",
               "timepoint": 20.0,
               "lower": 199871.71640625002,
               "upper": 12630250.1
            },
            {
               "trajectory": "infected_observable_state",
               "timepoint": 30.0,
               "lower": 5620028.8,
               "upper": 15742753.6
            },
            {
               "trajectory": "infected_observable_state",
               "timepoint": 40.0,
               "lower": 12423314.7,
               "upper": 15449825.4
            },
            {
               "trajectory": "infected_observable_state",
               "timepoint": 50.0,
               "lower": 8584623.0,
               "upper": 14134294.549999999
            },
            {
               "trajectory": "infected_observable_state",
               "timepoint": 60.0,
               "lower": 5497518.1,
               "upper": 10434119.049999999
            },
            {
               "trajectory": "infected_observable_state",
               "timepoint": 70.0,
               "lower": 3370351.9,
               "upper": 6929247.725
            },
            {
               "trajectory": "infected_observable_state",
               "timepoint": 80.0,
               "lower": 2008413.65,
               "upper": 4343339.999999999
            },
            {
               "trajectory": "infected_observable_state",
               "timepoint": 90.0,
               "lower": 1173560.55,
               "upper": 2626533.8499999996
            },
            {
               "trajectory": "infected_observable_state",
               "timepoint": 100.0,
               "lower": 676109.728125,
               "upper": 1550595.2499999998
            },
            {
               "trajectory": "infected_observable_state",
               "timepoint": 110.0,
               "lower": 385456.1421875,
               "upper": 900016.9312499999
            },
            {
               "trajectory": "infected_observable_state",
               "timepoint": 120.0,
               "lower": 218012.8078125,
               "upper": 515971.34374999994
            },
            {
               "trajectory": "infected_observable_state",
               "timepoint": 130.0,
               "lower": 122555.13046875,
               "upper": 293070.48124999995
            },
            {
               "trajectory": "infected_observable_state",
               "timepoint": 140.0,
               "lower": 68565.94453125,
               "upper": 165288.57890624998
            },
            {
               "trajectory": "recovered_observable_state",
               "timepoint": 10.0,
               "lower": 634.7149383544922,
               "upper": 16350.02587890625
            },
            {
               "trajectory": "recovered_observable_state",
               "timepoint": 20.0,
               "lower": 30994.567285156252,
               "upper": 3334179.6125
            },
            {
               "trajectory": "recovered_observable_state",
               "timepoint": 30.0,
               "lower": 1135747.7375,
               "upper": 12359140.1
            },
            {
               "trajectory": "recovered_observable_state",
               "timepoint": 40.0,
               "lower": 7871247.625,
               "upper": 20891279.9
            },
            {
               "trajectory": "recovered_observable_state",
               "timepoint": 50.0,
               "lower": 16880545.5,
               "upper": 27182029.3
            },
            {
               "trajectory": "recovered_observable_state",
               "timepoint": 60.0,
               "lower": 24285334.0,
               "upper": 31357073.2
            },
            {
               "trajectory": "recovered_observable_state",
               "timepoint": 70.0,
               "lower": 29454818.6,
               "upper": 33973078.8
            },
            {
               "trajectory": "recovered_observable_state",
               "timepoint": 80.0,
               "lower": 32788651.8,
               "upper": 35554659.8
            },
            {
               "trajectory": "recovered_observable_state",
               "timepoint": 90.0,
               "lower": 34841535.0,
               "upper": 36488217.6
            },
            {
               "trajectory": "recovered_observable_state",
               "timepoint": 100.0,
               "lower": 36068482.6,
               "upper": 37030015.8
            },
            {
               "trajectory": "recovered_observable_state",
               "timepoint": 110.0,
               "lower": 36786915.0,
               "upper": 37340595.6
            },
            {
               "trajectory": "recovered_observable_state",
               "timepoint": 120.0,
               "lower": 37201448.4,
               "upper": 37516991.6
            },
            {
               "trajectory": "recovered_observable_state",
               "timepoint": 130.0,
               "lower": 37438051.2,
               "upper": 37616471.6
            },
            {
               "trajectory": "recovered_observable_state",
               "timepoint": 140.0,
               "lower": 37571988.6,
               "upper": 37672268.8
            },
            {
               "trajectory": "susceptible_observable_state",
               "timepoint": 10.0,
               "lower": 35282473.8,
               "upper": 37714409.6
            },
            {
               "trajectory": "susceptible_observable_state",
               "timepoint": 20.0,
               "lower": 1884.361474609375,
               "upper": 36402182.199999996
            },
            {
               "trajectory": "susceptible_observable_state",
               "timepoint": 30.0,
               "lower": 3.477406860241672e-08,
               "upper": 11008859.64999999
            },
            {
               "trajectory": "susceptible_observable_state",
               "timepoint": 40.0,
               "lower": 2.0211695253385354e-18,
               "upper": 41040.607226562395
            },
            {
               "trajectory": "susceptible_observable_state",
               "timepoint": 50.0,
               "lower": 5.44092633562787e-26,
               "upper": 40.601443958282346
            },
            {
               "trajectory": "susceptible_observable_state",
               "timepoint": 60.0,
               "lower": 5.0570783539889405e-31,
               "upper": 0.12766883838921742
            },
            {
               "trajectory": "susceptible_observable_state",
               "timepoint": 70.0,
               "lower": 3.534263103153753e-34,
               "upper": 0.0022142167494166565
            },
            {
               "trajectory": "susceptible_observable_state",
               "timepoint": 80.0,
               "lower": 4.4309020313146606e-36,
               "upper": 0.0001601423182364664
            },
            {
               "trajectory": "susceptible_observable_state",
               "timepoint": 90.0,
               "lower": 4.074143260288291e-37,
               "upper": 3.163056330777169e-05
            },
            {
               "trajectory": "susceptible_observable_state",
               "timepoint": 100.0,
               "lower": 1.5671245316637535e-37,
               "upper": 1.1975939980857177e-05
            },
            {
               "trajectory": "susceptible_observable_state",
               "timepoint": 110.0,
               "lower": 1.3061870462480905e-37,
               "upper": 6.7763938886855375e-06
            },
            {
               "trajectory": "susceptible_observable_state",
               "timepoint": 120.0,
               "lower": 1.3061870462480905e-37,
               "upper": 4.877096631616933e-06
            },
            {
               "trajectory": "susceptible_observable_state",
               "timepoint": 130.0,
               "lower": 1.3061870462480905e-37,
               "upper": 4.041809268073834e-06
            },
            {
               "trajectory": "susceptible_observable_state",
               "timepoint": 140.0,
               "lower": 1.3061870462480905e-37,
               "upper": 3.6338352515485766e-06
            }
         ],
         "transform": [
            {
               "type": "collect",
               "sort": {
                  "field": [
                     "trajectory",
                     "timepoint"
                  ]
               }
            }
         ]
      },
      {
         "name": "traces",
         "values": [],
         "transform": [
            {
               "type": "filter",
               "expr": "isValid(datum.value)"
            },
            {
               "type": "collect",
               "sort": {
                  "field": [
                     "trajectory",
                     "timepoint"
                  ]
               }
            }
         ]
      },
      {
         "name": "points",
         "values": []
      },
      {
         "name": "markers_v",
         "values": []
      },
      {
         "name": "markers_h",
         "values": []
      },
      {
         "name": "selected",
         "on": [
            {
               "trigger": "clear",
               "remove": true
            },
            {
               "trigger": "!shift",
               "remove": true
            },
            {
               "trigger": "!shift && clicked",
               "insert": "clicked"
            },
            {
               "trigger": "shift && clicked",
               "toggle": "clicked"
            }
         ]
      },
      {
         "name": "selectedData",
         "on": [
            {
               "trigger": "clearData",
               "remove": true
            },
            {
               "trigger": "clickedData",
               "toggle": "clickedData"
            }
         ]
      }
   ]
}